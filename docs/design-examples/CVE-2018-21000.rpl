pattern CVE-2018-21000

meta {
    T1: ty
    T2: ty
    func: ident
    vec: ident
    ptr: ident
    cap: ident
    len: ident
    op: Operator
}

util {
    p1 = ```
        pub fn $func<$$(_:GArgs)> (mut $vec: Vec<$T1>) -> Vec<$T2> {
            #unordered! {
                let $ptr = $vec.as_mut_ptr();
                let $cap = $vec.capacity() $op size_of::<$T2>();
                let $len = $vec.len() $op size_of::<$T2>();
            }
            forget($vec);
            Vec::from_raw_parts($ptr as *mut $T2, $cap, $len)
        }
    ```
}

patt {
    p =
        | p1 {
            T2 = `u8`
            op = `*`
        }
        | p1 {
            T1 = `u8`
            op = `/`
        }
}