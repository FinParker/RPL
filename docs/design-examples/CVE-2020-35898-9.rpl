pattern CVE-2020-35898-9

meta {
    T: ty
    Cell: ident
    inner: ident
    get_mut: ident
}

util {
    p_struct = ```rust
        struct $Cell<$T> {
            $inner: Rc<UnsafeCell<$T>>,
        }
    ```

    p_clone = ```rust
        impl<$T> Clone for $Cell<$T> {
            fn clone(&self) -> Self {
                Self {
                    $inner: self.$inner.clone(),
                }
            }
        }
    ```

    p_get_mut = ```rust
        impl<$T> $Cell<$T> {
            fn $get_mut(&mut self) -> &mut $T {
                unsafe { &mut *self.$inner.as_ref().get() }
            }
        }
    ```
}

patt {
    p = p_struct & p_clone & p_get_mut
}
````

